(function(t){function e(e){for(var a,i,o=e[0],c=e[1],u=e[2],p=0,m=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(m.length)m.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},r={app:0},s=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/BetterNextBus/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2237:function(t,e,n){"use strict";var a=n("e096"),r=n.n(a);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("v-app",[n("router-view"),n("v-footer",{attrs:{color:"grey lighten-3",padless:""}},[n("v-row",{attrs:{justify:"center","no-gutters":""}},[n("v-btn",{staticClass:"my-2",attrs:{color:"teal",text:""},on:{click:function(e){return t.$router.push({name:"bus-list",params:{bus_stop_name:t.$store.state.stop_selected}})}}},[t._v(" Home ")]),n("v-btn",{staticClass:"my-2",attrs:{color:"teal",text:"",to:"/about"}},[t._v(" About ")]),n("v-col",{staticClass:"grey lighten-3 py-4 text-center teal--text caption",attrs:{cols:"12"}},[t._v(" Made with ðŸ’— by "),n("a",{staticStyle:{color:"teal"},attrs:{href:t.github_url,target:"_blank"}},[n("strong",[t._v("@BetterNextBus")])]),n("br"),t._v(" Copyright Â© 2019 - "+t._s((new Date).getFullYear())+" ")])],1)],1)],1)],1)},s=[],i="https://github.com/liujiajun/BetterNextBus",o="bGl1amlhanVuMTk5OUBnbWFpbC5jb20=",c={data:function(){return{github_url:i}}},u=c,l=n("2877"),p=n("6544"),m=n.n(p),v=n("7496"),h=n("8336"),d=n("62ad"),g=n("553a"),f=n("0fd9"),_=Object(l["a"])(u,r,s,!1,null,null,null),b=_.exports;m()(_,{VApp:v["a"],VBtn:h["a"],VCol:d["a"],VFooter:g["a"],VRow:f["a"]});var w=n("f309");n("5363");a["a"].use(w["a"]);var k=new w["a"]({}),x=n("8c4f"),y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("v-app",[n("div",[n("v-toolbar",{attrs:{dark:"",color:"teal"},scopedSlots:t._u([{key:"extension",fn:function(){return[n("v-tabs",{attrs:{"fixed-tabs":"","background-color":"transparent"},model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},[n("v-tab",{on:{click:function(e){t.$router.push({name:"bus-list",params:{bus_stop_name:t.$store.state.stop_selected}}).catch((function(e){return t.console.log(e)}))}}},[n("v-icon",[t._v("mdi-bus-stop")])],1),n("v-tab",{on:{click:function(e){t.$router.push({name:"service-card",params:{service_name:t.$store.state.service_selected}}).catch((function(e){return t.console.log(e)}))}}},[n("v-icon",[t._v("mdi-map-search-outline")])],1)],1)]},proxy:!0}])},[n("v-toolbar-title",{staticClass:"title mr-6 hidden-sm-and-down"},[t._v("BetterNextBus")]),n("v-autocomplete",{staticClass:"mx-4",attrs:{items:t.autocomplete_items,"prepend-icon":"mdi-magnify",label:"Enter bus stop or service",flat:"","hide-details":"","hide-selected":"","auto-select-first":"","item-text":"search_field","item-value":"name",chips:"","solo-inverted":""},on:{input:t.selectFromAutocomplete},scopedSlots:t._u([{key:"no-data",fn:function(){return[n("v-list-item",[n("v-list-item-title",[t._v(" Search for a "),n("strong",[t._v("Bus stop")]),t._v(" or "),n("strong",[t._v("Bus service")])])],1)]},proxy:!0},{key:"selection",fn:function(e){var a=e.attr,r=(e.on,e.item),s=e.selected;return[n("v-chip",t._b({staticClass:"white--text",attrs:{"input-value":s,color:"blue-grey",close:""},on:{"click:close":function(e){return t.$store.commit("setAutocompleteSelected","")}}},"v-chip",a,!1),[n("v-icon",{attrs:{left:""}},[t._v("mdi-bus-stop")]),n("span",{domProps:{textContent:t._s("stop"===r.type?r.sub_title:r.title)}})],1)]}},{key:"item",fn:function(e){var a=e.item;return["stop"===a.type?n("v-list-item-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v(" "+t._s(a.name.charAt(0))+" ")]):t._e(),"service"===a.type?n("v-list-item-avatar",{staticClass:"font-weight-light white--text",attrs:{color:"orange"}},[t._v(" "+t._s(a.name.length>4?a.name.charAt(0):a.name)+" ")]):t._e(),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(a.title)}}),n("v-list-item-subtitle",{domProps:{textContent:t._s(a.sub_title)}})],1),n("v-list-item-action",[n("v-icon",[t._v(t._s("stop"===a.type?"mdi-bus-stop":"mdi-bus"))])],1)]}}]),model:{value:t.$store.state.autocomplete_selected,callback:function(e){t.$set(t.$store.state,"autocomplete_selected",e)},expression:"$store.state.autocomplete_selected"}}),n("v-btn",{attrs:{icon:"",loading:t.locating,disabled:t.locating},on:{click:t.updateBusStopsByDistance}},[n("v-icon",[t._v("mdi-crosshairs-gps")])],1),n("v-progress-linear",{attrs:{active:t.loading,indeterminate:t.loading,color:"white",absolute:"",bottom:""}})],1),n("v-snackbar",{attrs:{color:"error"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbar_message)+" "),n("v-btn",{attrs:{color:"white",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v(" Close ")])],1)],1),n("keep-alive",[n("router-view",{on:{onLoadingStateChange:t.setLoadingState}})],1)],1)],1)},C=[],S=(n("a4d3"),n("e01a"),n("d28b"),n("7db0"),n("b0c0"),n("d3b7"),n("3ca3"),n("2ca0"),n("ddb0"),n("96cf"),{name:"App",mounted:function(){},created:function(){var t,e,n,a,r,s;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return this.loading=!0,i.prev=1,i.next=4,regeneratorRuntime.awrap(this.$store.dispatch("getStops"));case 4:return i.next=6,regeneratorRuntime.awrap(this.$store.dispatch("getServices"));case 6:i.next=12;break;case 8:i.prev=8,i.t0=i["catch"](1),this.snackbar_message="Timed out. Check Internet connection.",this.snackbar=!0;case 12:return i.prev=12,this.loading=!1,i.finish(12);case 15:for(void 0!==this.$route.params.bus_stop_name?this.$store.commit("setAutocompleteSelected",this.$route.params.bus_stop_name):void 0!==this.$route.params.service_name&&this.$store.commit("setAutocompleteSelected",this.$route.params.service_name),i.prev=16,t=!0,e=!1,n=void 0,i.prev=20,a=this.$store.state.services[Symbol.iterator]();!(t=(r=a.next()).done);t=!0)s=r.value,this.$store.dispatch("getPickupPoints",s.service_name),this.$store.dispatch("getCheckPoints",s.service_name);i.next=28;break;case 24:i.prev=24,i.t1=i["catch"](20),e=!0,n=i.t1;case 28:i.prev=28,i.prev=29,t||null==a.return||a.return();case 31:if(i.prev=31,!e){i.next=34;break}throw n;case 34:return i.finish(31);case 35:return i.finish(28);case 36:console.log("Finished loading checkpoints and pick-up points."),i.next=43;break;case 39:i.prev=39,i.t2=i["catch"](16),this.snackbar_message="Timed out. Check Internet connection.",this.snackbar=!0;case 43:case"end":return i.stop()}}),null,this,[[1,8,12,15],[16,39],[20,24,28,36],[29,,31,35]])},methods:{setLoadingState:function(t){this.loading=t},getLocation:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){"geolocation"in navigator||e(new Error("Geolocation is not available.")),navigator.geolocation.getCurrentPosition((function(e){t({latitude:e.coords.latitude,longitude:e.coords.longitude})}),(function(t){e(t)}))})));case 1:case"end":return t.stop()}}))},locate:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(this.getLocation());case 3:t=e.sent,this.$store.commit("setCurrentLocation",t),e.next=12;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.code===e.t0.PERMISSION_DENIED?this.snackbar_message="Permission denied. Try enabling location service.":e.t0.code===e.t0.POSITION_UNAVAILABLE||e.t0.code===e.t0.TIMEOUT?this.snackbar_message="Geolocation not available at the moment. Try again later.":this.snackbar_message="Unknown error when getting geolocation.",this.snackbar=!0,this.locating=!1;case 12:case"end":return e.stop()}}),null,this,[[0,7]])},updateBusStopsByDistance:function(){var t=this;this.locating=!0,this.locate().then((function(){t.$store.commit("sortStops",t.$store.state.current_location),t.locating=!1,t.$router.push({name:"bus-list",params:{bus_stop_name:t.$store.state.stops[0].name}}).catch((function(t){return console.log(t)}))}))},selectFromAutocomplete:function(){var t=this,e=this.autocomplete_items.find((function(e){return e.name===t.$store.state.autocomplete_selected}));"stop"===e.type?this.$router.push({name:"bus-list",params:{bus_stop_name:this.$store.state.autocomplete_selected}}).catch((function(t){return console.log(t)})):this.$router.push({name:"service-card",params:{service_name:this.$store.state.autocomplete_selected}}).catch((function(t){return console.log(t)}))}},data:function(){return{loading:!1,locating:!1,location:null,snackbar:!1,snackbar_message:""}},watch:{"$route.path":function(){this.$route.path.startsWith("/stops")?(this.$store.commit("setAutocompleteSelected",this.$route.params.bus_stop_name),this.$store.commit("setStopSelected",this.$route.params.bus_stop_name)):this.$route.path.startsWith("/services")&&(this.$store.commit("setAutocompleteSelected",this.$route.params.service_name),this.$store.commit("setServiceSelected",this.$route.params.service_name))}},computed:{autocomplete_items:function(){var t=[],e=!0,n=!1,a=void 0;try{for(var r,s=this.$store.state.stops[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var i=r.value;t.push({type:"stop",search_field:i.search_field,name:i.name,title:i.long_name,sub_title:i.short_name})}}catch(v){n=!0,a=v}finally{try{e||null==s.return||s.return()}finally{if(n)throw a}}var o=!0,c=!1,u=void 0;try{for(var l,p=this.$store.state.services[Symbol.iterator]();!(o=(l=p.next()).done);o=!0){var m=l.value;t.push({type:"service",search_field:m.service_name+m.description,name:m.service_name,title:m.service_name,sub_title:m.description})}}catch(v){c=!0,u=v}finally{try{o||null==p.return||p.return()}finally{if(c)throw u}}return t},active_tab:{get:function(){return this.$route.path.startsWith("/stops")?0:this.$route.path.startsWith("/services")?1:0},set:function(){}}}}),A=S,V=n("c6a6"),R=n("cc20"),P=n("132d"),B=n("da13"),I=n("1800"),L=n("8270"),T=n("5d23"),$=n("8e36"),E=n("2db4"),N=n("71a3"),j=n("fe57"),M=n("71d9"),O=n("2a7f"),U=Object(l["a"])(A,y,C,!1,null,null,null),D=U.exports;m()(U,{VApp:v["a"],VAutocomplete:V["a"],VBtn:h["a"],VChip:R["a"],VIcon:P["a"],VListItem:B["a"],VListItemAction:I["a"],VListItemAvatar:L["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VProgressLinear:$["a"],VSnackbar:E["a"],VTab:N["a"],VTabs:j["a"],VToolbar:M["a"],VToolbarTitle:O["a"]});var K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"about"},[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-card",{staticClass:"mx-auto",attrs:{flat:"",color:"transparent"}},[a("v-img",{attrs:{contain:"true",height:"250",src:n("9b19")}}),a("v-card-title",{staticClass:"headline font-weight-bold justify-center teal--text"},[t._v("NUSBuses")]),a("v-card-subtitle",{staticClass:"text-center"},[t._v("Delightful shuttle bus tracker for the NUS community")]),a("div",{staticClass:"feedback"},[a("v-card-title",{staticClass:"subtitle justify-center teal--text"},[t._v("Give Us Feedback")]),a("v-card-text",{staticClass:"text-center"},[t._v("NUSBuses is in testing phase. We value your feedback including bug report, feature request. You can contact us through Github issues or email. ")]),a("v-row",{attrs:{justify:"center"}},[a("v-btn",{attrs:{text:"",large:"",fab:"",href:t.github_url+"/issues"}},[a("v-icon",{attrs:{large:""}},[t._v("mdi-github-circle")])],1),a("v-btn",{attrs:{text:"",large:"",fab:"",href:"mailto:"+t.email_decoded}},[a("v-icon",{attrs:{large:""}},[t._v("mdi-email")])],1)],1)],1),a("div",{staticClass:"contribute"},[a("v-card-title",{staticClass:"subtitle justify-center teal--text"},[t._v("Contribute")]),a("v-card-text",{staticClass:"text-center"},[t._v("NUSBuses is a student-initiated, open-source project. Contribute to NUSBuses now on GitHub! ")]),a("v-row",{attrs:{justify:"center"}},[a("v-btn",{attrs:{text:"",large:"",fab:"",color:"black",href:t.github_url,target:"_blank"}},[a("v-icon",{attrs:{large:""}},[t._v("mdi-github-circle")])],1)],1)],1)],1)],1)],1)],1)],1)},Y=[],G={data:function(){return{github_url:i,email_decoded:atob(o)}}},W=G,Z=n("b0af"),q=n("99d9"),F=n("a523"),H=n("adda"),Q=Object(l["a"])(W,K,Y,!1,null,null,null),J=Q.exports;m()(Q,{VBtn:h["a"],VCard:Z["a"],VCardSubtitle:q["b"],VCardText:q["c"],VCardTitle:q["d"],VCol:d["a"],VContainer:F["a"],VIcon:P["a"],VImg:H["a"],VRow:f["a"]});var X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-tabs",{attrs:{"background-color":"transparent","show-arrows":""},model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},[n("v-tabs-slider",{attrs:{color:"teal"}}),t._l(t.$store.state.services,(function(e){return n("v-tab",{key:e.service_name,on:{click:function(n){return t.selectTab(e.service_name)}}},[t._v(" "+t._s(e.service_name)+" ")])}))],2),n("router-view")],1)},z=[],tt=(n("c740"),{name:"service-list",data:function(){return{}},methods:{selectTab:function(t){this.$router.push({name:"service-card",params:{service_name:t}}).catch((function(t){return console.log(t)}))}},computed:{active_tab:{get:function(){var t=this,e=this.$store.state.services.findIndex((function(e){return e.service_name===t.$route.params.service_name}));return void 0===e?0:e},set:function(){}}}}),et=tt,nt=n("9a96"),at=Object(l["a"])(et,X,z,!1,null,"21347640",null),rt=at.exports;m()(at,{VContainer:F["a"],VTab:N["a"],VTabs:j["a"],VTabsSlider:nt["a"]});var st,it,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"bus-list"}},[n("v-container",{attrs:{"fill-height":""}},[n("v-row",{attrs:{dense:""}},t._l(t.service_timings,(function(e,a){return n("v-col",{key:a,attrs:{cols:12}},[n("v-card",{attrs:{color:"teal",outlined:"",dark:""}},[n("v-list-item",{attrs:{"two-line":""}},[n("v-list-item-avatar",{attrs:{color:"white",size:"48"}},[n("v-icon",{attrs:{color:"teal"}},[t._v("mdi-bus")])],1),n("v-list-item-content",[n("v-container",{staticClass:"pa-0"},[n("v-row",{attrs:{justify:"space-between"}},[n("v-col",{attrs:{cols:"6"}},[n("v-list-item-title",{staticClass:"headline"},[t._v(t._s(e.service_name)+" ")])],1),n("v-col",{attrs:{cols:"6"}},[n("v-list-item-title",{staticClass:"headline text-right"},[n("span",{staticClass:"headline"},[t._v(t._s(e.arrival_time))]),"1"==e.arrival_time?n("span",[t._v(" min")]):t._e(),"1"!=e.arrival_time&&"Arr"!=e.arrival_time&&"-"!=e.arrival_time?n("span",[t._v(" mins ")]):t._e()]),n("v-list-item-subtitle",{staticClass:"text-right"},[n("span",[t._v(t._s(e.next_arrival_time))]),"1"==e.next_arrival_time?n("span",[t._v(" min")]):t._e(),"1"!=e.next_arrival_time&&"Arr"!=e.next_arrival_time&&"-"!=e.next_arrival_time?n("span",[t._v(" mins ")]):t._e()])],1)],1)],1)],1)],1),n("v-expand-transition",[t.service_timings[a].show_map?n("div",[n("route-map",{attrs:{bus:t.service_timings[a].service_name,stop:t.bus_stop_name}})],1):t._e()]),n("v-card-actions",[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.gotoService(t.service_timings[a].service_name)}}},[n("v-icon",[t._v("mdi-map-search-outline")])],1),n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.showMap(a)}}},[t._v(" LIVE MAP "),n("v-icon",[t._v(t._s(t.service_timings[a].show_map?"mdi-chevron-up":"mdi-chevron-down")+" ")])],1)],1)],1)],1)})),1)],1)],1)},ct=[],ut=(n("4160"),n("159b"),n("bc3a")),lt=n.n(ut),pt="https://better-nextbus.appspot.com",mt=lt.a.create({baseURL:pt}),vt="/BusStops",ht={get:function(){var t,e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(mt.get(vt));case 2:return t=n.sent,e=[],t.data["BusStopsResult"]["busstops"].forEach((function(t){e.push({name:t["name"],caption:t["caption"],short_name:t["ShortName"],long_name:t["LongName"],search_field:t["ShortName"]+t["LongName"],latitude:t["latitude"],longitude:t["longitude"]})})),n.abrupt("return",e);case 6:case"end":return n.stop()}}))}},dt="/ServiceDescription",gt={get:function(){var t,e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(mt.get(dt));case 2:return t=n.sent,e=[],t.data["ServiceDescriptionResult"]["ServiceDescription"].forEach((function(t){e.push({service_name:t["Route"],description:t["RouteDescription"],check_points:[],pickup_points:[]})})),n.abrupt("return",e);case 6:case"end":return n.stop()}}))}},ft="/CheckPoint?route_code=",_t={get:function(t){var e,n;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(mt.get(ft+t));case 2:return e=a.sent,n=[],e.data["CheckPointResult"]["CheckPoint"].forEach((function(t){n.push({lat:t["latitude"],lng:t["longitude"]})})),a.abrupt("return",n);case 6:case"end":return a.stop()}}))}},bt="/PickupPoint?route_code=",wt=[{original:"PGPE",new:"PGP"},{original:"PGPEN",new:"PGP"},{original:"PGPEND",new:"PGP"},{original:"KTR-E",new:"KR-BT"},{original:"KTR-EN",new:"KR-BT"},{original:"KR-BTE",new:"KR-BT"},{original:"innovation 4.0(R)",new:"innovation 4.0"}],kt={get:function(t){var e,n;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(mt.get(bt+t));case 2:return e=a.sent,n=[],e.data["PickupPointResult"]["pickuppoint"].forEach((function(t){var e,a=wt.find((function(e){return e.original===t["busstopcode"]}));e=void 0!==a?a.new:t["busstopcode"],n.push({lat:t["lat"],lng:t["lng"],name:e})})),a.abrupt("return",n);case 6:case"end":return a.stop()}}))}},xt="/ShuttleService?busstopname=",yt={get:function(t){var e,n;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(mt.get(xt+t));case 2:return e=a.sent,n=[],e.data["ShuttleServiceResult"]["shuttles"].forEach((function(t){n.push({service_name:t["name"],arrival_time:t["arrivalTime"],next_arrival_time:t["nextArrivalTime"],show_map:!1})})),a.abrupt("return",n);case 6:case"end":return a.stop()}}))}},Ct="/ActiveBus?token=8UVANBHAKJNK&route_code=",St={get:function(t){var e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(mt.get(Ct+t));case 2:return e=n.sent,n.abrupt("return",e.data["ActiveBusResult"]["activebus"]);case 4:case"end":return n.stop()}}))}},At={busStops:ht,serviceDescriptions:gt,checkPoints:_t,pickupPoints:kt,serviceTimingAtBusStop:yt,activeBus:St},Vt={get:function(t){return At[t]}},Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.mapName}},[n("v-container",{staticClass:"route-map",attrs:{fluid:""}})],1)},Pt=[],Bt="AIzaSyBx7hn_RmpcwMh7yJVH2JFzo29Oj9EnKOU",It="gmapsCallback",Lt=!!window.google,Tt=new Promise((function(t,e){st=t,it=e}));function $t(){if(Lt)return Tt;Lt=!0,window[It]=function(){return st(window.google)};var t=document.createElement("script");return t.async=!0,t.defer=!0,t.src="https://maps.googleapis.com/maps/api/js?key=".concat(Bt,"&callback=").concat(It),t.onerror=it,document.querySelector("head").appendChild(t),Tt}n("09bd").shim();var Et={name:"route-map",props:["bus","stop"],data:function(){return{mapName:this.stop+"-"+this.bus,stop_name:this.stop,bus_name:this.bus,bus_live_locations:[],live_location_markers:{},gmap:null,google:null,timer:null}},methods:{getRoute:function(t){this.$store.state.services.forEach((function(e){if(e.service_name===t)return console.log(e),e}))},updateBusLiveLocations:function(){var t,e,a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(""!==this.bus_name){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,regeneratorRuntime.awrap(Vt.get("activeBus").get(this.bus_name));case 4:for(e in t=s.sent,t)a=t[e],void 0===this.live_location_markers[a["vehplate"]]?(console.log("initial"+a["lat"]+" "+a["lng"]),this.live_location_markers[a["vehplate"]]=new this.google.maps.Marker({position:new this.google.maps.LatLng(a["lat"],a["lng"]),icon:{url:n("b81e"),anchor:new this.google.maps.Point(18,18)}}),this.live_location_markers[a["vehplate"]].setMap(this.gmap)):(console.log("updating"+a["lat"]+" "+a["lng"]),r=this.live_location_markers[a["vehplate"]],r.setPosition(new this.google.maps.LatLng(a["lat"],a["lng"])));case 6:case"end":return s.stop()}}),null,this)}},mounted:function(){var t,e,n=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regeneratorRuntime.awrap($t());case 3:this.google=a.sent,t=document.getElementById(this.mapName).getElementsByClassName("route-map")[0],e={zoom:17,center:new this.google.maps.LatLng(1.29199190036396,103.78027611345),disableDefaultUI:!0,fullscreenControl:!0},this.gmap=new this.google.maps.Map(t,e),this.$store.state.services.forEach((function(t){if(t.service_name===n.bus_name){var e=new n.google.maps.Polyline({path:t.check_points,geodesic:!0,strokeColor:"teal",strokeOpacity:1,strokeWeight:2});e.setMap(n.gmap),t.pickup_points.forEach((function(t){t.name===n.stop_name&&n.gmap.setCenter(t);var e=new n.google.maps.Marker({position:t,label:{text:t.name,color:"white",fontSize:"8px"}});e.setMap(n.gmap)}))}})),this.timer=setInterval(this.updateBusLiveLocations,5e3),this.updateBusLiveLocations(),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](0),console.log(a.t0);case 15:case"end":return a.stop()}}),null,this,[[0,12]])},beforeDestroy:function(){clearInterval(this.timer)}},Nt=Et,jt=(n("2237"),Object(l["a"])(Nt,Rt,Pt,!1,null,"44155ef7",null)),Mt=jt.exports;m()(jt,{VContainer:F["a"]}),n("09bd").shim();var Ot={name:"bus-list",components:{RouteMap:Mt},props:{bus_stop_name:String},created:function(){var t=this;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:this.timer=setInterval((function(){t.updateBusTiming(!1)}),3e4),this.updateBusTiming(!0);case 2:case"end":return e.stop()}}),null,this)},data:function(){return{service_timings:[],timer:""}},methods:{updateBusTiming:function(t){var e,n=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(""!==this.bus_stop_name&&null!==this.bus_stop_name&&void 0!==this.bus_stop_name){a.next=2;break}return a.abrupt("return");case 2:if(!t){a.next=11;break}return this.$emit("onLoadingStateChange",!0),a.prev=4,a.next=7,regeneratorRuntime.awrap(Vt.get("serviceTimingAtBusStop").get(this.bus_stop_name));case 7:this.service_timings=a.sent;case 8:return a.prev=8,this.$emit("onLoadingStateChange",!1),a.finish(8);case 11:return a.prev=11,a.next=14,regeneratorRuntime.awrap(Vt.get("serviceTimingAtBusStop").get(this.bus_stop_name));case 14:e=a.sent,e.forEach((function(t){var e=n.service_timings.find((function(e){return e.service_name===t.service_name}));void 0!==e&&null!==e&&(e.arrival_time=t.arrival_time,e.next_arrival_time=t.next_arrival_time)})),a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](11),this.$emit("onLoadingStateChange",!1);case 21:case"end":return a.stop()}}),null,this,[[4,,8,11],[11,18]])},showMap:function(t){for(var e=0;e<this.service_timings.length;e++)t===e?this.service_timings[t].show_map=!this.service_timings[t].show_map:this.service_timings[e].show_map=!1},gotoService:function(t){this.$router.push({name:"service-card",params:{service_name:t}}).catch((function(t){return console.log(t)}))}},watch:{bus_stop_name:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.updateBusTiming(!0);case 1:case"end":return t.stop()}}),null,this)}},beforeDestroy:function(){clearInterval(this.timer)}},Ut=Ot,Dt=n("0789"),Kt=n("2fa4"),Yt=Object(l["a"])(Ut,ot,ct,!1,null,null,null),Gt=Yt.exports;m()(Yt,{VBtn:h["a"],VCard:Z["a"],VCardActions:q["a"],VCol:d["a"],VContainer:F["a"],VExpandTransition:Dt["a"],VIcon:P["a"],VListItem:B["a"],VListItemAvatar:L["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VRow:f["a"],VSpacer:Kt["a"]});var Wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"service-card"}},[n("v-card",{staticClass:"transparent",attrs:{flat:""}},[n("v-list",{staticClass:"transparent",attrs:{dense:""}},t._l(t.service.pickup_points,(function(e,a){return n("v-list-item",{key:a},[n("v-list-item-avatar",{staticClass:"font-weight-light white--text",attrs:{color:"indigo",size:"32"}},[t._v(" "+t._s(e.name.charAt(0))+" ")]),n("v-list-item-content",[n("v-list-item-title",[t._v(" "+t._s(t.getStop(e.name).long_name)+" ")])],1),n("v-list-item-action",[n("v-btn",{attrs:{icon:"",color:"teal"},on:{click:function(n){return t.gotoStop(e.name)}}},[n("v-icon",[t._v("mdi-bus-stop")])],1)],1)],1)})),1)],1)],1)},Zt=[],qt={name:"service-card",methods:{getStop:function(t){return void 0===this.$store.state.stops.find((function(e){return e.name===t}))?(console.log("Undefined "+t),t):this.$store.state.stops.find((function(e){return e.name===t}))},gotoStop:function(t){this.$router.push({name:"bus-list",params:{bus_stop_name:t}}).catch((function(t){return console.log(t)}))}},computed:{service:function(){var t=this;return this.$store.state.services.find((function(e){return e.service_name===t.$store.state.service_selected}))}}},Ft=qt,Ht=n("8860"),Qt=Object(l["a"])(Ft,Wt,Zt,!1,null,"73e4a4c0",null),Jt=Qt.exports;m()(Qt,{VBtn:h["a"],VCard:Z["a"],VIcon:P["a"],VList:Ht["a"],VListItem:B["a"],VListItemAction:I["a"],VListItemAvatar:L["a"],VListItemContent:T["a"],VListItemTitle:T["c"]}),a["a"].use(x["a"]);var Xt=[{path:"/",name:"home",component:D,children:[{path:"stops",name:"bus-list",component:Gt,props:!0,children:[{path:":bus_stop_name",name:"bus-list",component:Gt,props:!0}]},{path:"services",name:"service-list",component:rt,props:!0,children:[{path:":service_name",name:"service-card",component:Jt,props:!0}]}]},{path:"/about",component:J}],zt=new x["a"]({routes:Xt,scrollBehavior:function(t,e,n){return{x:0,y:0}}}),te=zt,ee=(n("4e827"),n("a9e3"),n("2f62"));a["a"].use(ee["a"]);var ne=new ee["a"].Store({state:{stops:[],services:[],active_tab:0,autocomplete_selected:"",stop_selected:"UTown",service_selected:"A1",current_location:null},mutations:{getStops:function(t,e){t.stops=e},sortStops:function(t,e){t.stops.sort((function(t,n){function a(t,e,n,a,r){if(t==n&&e==a)return 0;var s=Math.PI*t/180,i=Math.PI*n/180,o=e-a,c=Math.PI*o/180,u=Math.sin(s)*Math.sin(i)+Math.cos(s)*Math.cos(i)*Math.cos(c);return u>1&&(u=1),u=Math.acos(u),u=180*u/Math.PI,u=60*u*1.1515,"K"==r&&(u*=1.609344),"N"==r&&(u*=.8684),u}var r=a(Number(t.latitude),Number(t.longitude),e.latitude,e.longitude,"M"),s=a(Number(n.latitude),Number(n.longitude),e.latitude,e.longitude,"M");return r>s?1:r<s?-1:0}))},getServices:function(t,e){t.services=e},addCheckPoints:function(t,e){t.services.find((function(t){return t.service_name===e.service_name})).check_points=e.checkPoints},addPickupPoints:function(t,e){t.services.find((function(t){return t.service_name===e.service_name})).pickup_points=e.pickupPoints},setStopSelected:function(t,e){t.stop_selected=e},setServiceSelected:function(t,e){t.service_selected=e},setAutocompleteSelected:function(t,e){t.autocomplete_selected=e},setActiveTab:function(t,e){t.active_tab=e},setCurrentLocation:function(t,e){t.current_location=e}},actions:{getStops:function(t){var e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return e=t.commit,n.next=3,regeneratorRuntime.awrap(Vt.get("busStops").get().then((function(t){return e("getStops",t)})));case 3:case"end":return n.stop()}}))},getServices:function(t){var e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return e=t.commit,n.next=3,regeneratorRuntime.awrap(Vt.get("serviceDescriptions").get().then((function(t){return e("getServices",t)})));case 3:case"end":return n.stop()}}))},getCheckPoints:function(t,e){var n=t.commit;Vt.get("checkPoints").get(e).then((function(t){return n("addCheckPoints",{service_name:e,checkPoints:t})}))},getPickupPoints:function(t,e){var n=t.commit;Vt.get("pickupPoints").get(e).then((function(t){return n("addPickupPoints",{service_name:e,pickupPoints:t})}))}},modules:{}});a["a"].config.productionTip=!0,a["a"].prototype.$hostname=a["a"].config.productionTip?"https://better-nextbus.appspot.com/":"http://127.0.0.1:5000/",new a["a"]({vuetify:k,router:te,store:ne,render:function(t){return t(b)}}).$mount("#app")},"9b19":function(t,e,n){t.exports=n.p+"img/logo.42b2e995.svg"},b81e:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAABTZJREFUWAnNWM1rHGUYf+d7Ntltu2ls0pRNsWhvGuieBJODUCVCKRS2SOyhINKjeJOCMFDoRUUE/wBPHrpQKNXmYOsliofaQvy4pAcxMR9oks3n7szOvDN9fq++6+5kZnZjiWRheGfe5+P97TPP5yhsn7/IcdTlR4/svkLBqm9va5qiaKquq1ATBkHIo4gTjRPNO1kuu4rjhPs5QumVeaFSyWmu228oitmrDPj8KGpy294tVauNXuS6AnoyOWnl8/kjuucZvShM4wksy9/Z2dl6cXraS+PBfiqgKIqU2uXLR7jn9Wcp2C9Ns6zd4q1bW4qiREmyiYDgJ9uzs0WPcytJ6Fn3LE3zCmNjtST/2gMIYHZmZwddzvVnPThL3ta0ID82thoHJaJDCuI1wTIHDQbn4QychTPl+Vg7rCB8pofX1Gj8GzANzjsU5jSt5Ru5XK79rD33cImA/JQIm5LYUoZoOmYYxyUhaZVAAMINQ8WjazsIOqxc0PXQUtXIpkuC6wZsw/fXZPS1LITQZl56RAKMBLLabGq7BGSdc5VMrwb/mF2nyCHfCAfo6idgg6bJAYw1GlEWKHE2Y3/BCMJCSHq25xWTrII9CWaTQKwRmMVmU6fVIIDaRhDolPyElShphsd0PSDL8OOm6Z8yzYBWfpTAwVpZoFzLqiF5CgshAzOl9fY6cLWDWXFdfZ4SJFnINM+eLV69efPqidHRcauv7xSEvHp98c/5+Zkvr1//4o+5uRpZr+mHoc9sOyBymGUpgYH+u4IwX338eLgDRdsDANV8X10iML+7rvGb69qTjjP+ysWLH7LvZoab337D+MKCkNBKJWa+dp6xV8dXfrhz58a048w8b9vuadv2RwhU0TDCLCsNnju3ol0rFHJUIO02DK1baZ0VzxOWIVD2eceZmHjj9c+9Tz4qePe+YuHaGmMBGYAu3Ps/PmTsyVz+hbevvGmWSr/+8uDBoqKqoUX+1YcI5JwZRnIV2lxaClRU7RaChBtEExwYPoPXBMvUP/tU8X/+KYH77y3QwANeyEAWOqArVYgIwKKihchiQlgjmuDAU+QzeE1ZYKQuwUO8kIEsdMRThOSVK7Co6GfkRnxFmCPXILQRTeTAE/CZXn/ghdNDFjqgCzrT5EVvJZurNCbsI88gtCmaRqQDZ/FLGngRgZCVuUrSklZg6ciySUz/956KtrPbocjASHrIMwjtXn/ghQxkoaObHLCo6IHTGJFdRV2iUoAMjKQn8kyaQGwfvJCBLEoKdMn6FmMVj8CCsE8FBC4US9QmlANkYCQ946WXk/R17Ake4oUMZKEDujqYYg/AgrBPr6gkgOKIQona1KRygAzc9977URYo0MADXshAFjpEoY2BaH8EFu3jqSleX17OtxPkvciolFlVqnNKREmWsejh/ftLyMCn33m3bJwYykdbmyyq15lC2Vc/c4bZlbeYNnVl5fuv732A0lGyba9kWcGQZXGyUGaBHSqXN0ROWLpwYTBtvJHlA5U+XlyR9JCbkA7wJ9qLKyxD7UdzlKaNYapj3So+xqWRu3dXBaDD1H60suZypfJc1uwlLYV6tN8GDZGVVeUxs52sVkWD1uoYMcRltbBCITo/Ug7nBLBhuuL16b+0sDhb+m3LQthYr1SO9jIYwlryF69NACxpWVaRPBgcB6rVvU0+GMQYdOnSwEENiBKEXMXAePv2evsU21HLQMBEiSFOCh3UijPE9BorKR2vTB5+qEbpFihqOQ7NxwYJCuuh+RzTDgr3h+aDVRwY/OsgP+k9BWRfZyon6+UbAAAAAElFTkSuQmCC"},e096:function(t,e,n){}});
//# sourceMappingURL=app.fcf37407.js.map